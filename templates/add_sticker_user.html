{% extends "base.html" %}
{% block title %}Add your sticker{% endblock %}
{% block content %}


    <div class="mt-4">
        <a href="{{ url_for('shop.index') }}" class="text-decoration-none text-muted small d-inline-flex align-items-center">
            <i class="bi bi-chevron-left me-1"></i>
            {{_('Back to All Stickers')}}
        </a>
    </div>
    <!-- UPLOADIN THE STICKERS -->
    <div class="row justify-content-center">

        <div class="col-md-8 col-lg-6">

            <div class="card shadow-sm border-0 mt-4">

                <div class="card-body p-4">
                    <form action="{{ url_for('shop.request_sticker') }}" method="POST" enctype="multipart/form-data">

                        <h2 class="card-title text-center mb-4">{{_('Create Your Own Sticker')}}</h2>

                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="nameInput" name="name" placeholder="{{_('Sticker Name')}}" required>
                            <label for="nameInput">{{_('Sticker Name')}}</label>
                        </div>

                        <div class="form-floating mb-3">
                            <textarea class="form-control" placeholder="{{_('Description')}}" id="descInput" name="description" style="height: 100px"></textarea>
                            <label for="descInput">{{_('Description (Optional)')}}</label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" value="yes" id="approveCheck" name="request_approval">
                            <label class="form-check-label" for="approveCheck" style="display: contents;">
                                {{_('Submit for Admin Approval to Post on Dashboard')}}
                            </label>
                            <i class="bi bi-info-circle-fill ms-1" 
                                id="infoIconApproval"
                                style="cursor: pointer; font-size: 1rem;">
                            </i>
                        </div>

                        <div id="infoBoxApproval" class="custom-info-box d-none" style="z-index: 1000;">
                            <div class="d-flex text-start">
                                <i class="bi bi-exclamation-triangle-fill text-warning me-2 mt-1"></i>
                                <div>
                                    <strong>{{_('Important:')}}</strong> 
                                    {{_('By ticking this box, you give us the permission to put your custom sticker on the dashboard, allowing other users to order it.')}}
                                </div>
                            </div>
                        </div>
                        <div class="mb-4 position-relative">
                            <div class="d-flex align-items-center mb-2">
                                <label for="imageInput" class="form-label text-muted mb-0">
                                    {{_('Sticker Image')}}
                                </label>
                                <i class="bi bi-info-circle-fill ms-2" 
                                    id="infoIcon"
                                    style="cursor: pointer; font-size: 1rem;">
                                </i>
                            </div>
                        </div>
                            <div id="infoBox" class="custom-info-box d-none" style="z-index: 1000;">
                                <div class="d-flex text-start">
                                    <i class="bi bi-exclamation-triangle-fill text-warning me-2 mt-1"></i>
                                    <div>
                                        <strong>{{_('Important:')}}</strong> 
                                        {{_('All stickers are printed in the size of 80x80mm. We print the stickers the way the image is uploaded. If you want to change the look of the sticker (remove background or add stroke), you have to do it manually.')}}
                                    </div>
                                </div>
                            </div>
                        <input type="file" class="form-control" id="imageInput" name="image" required>
                        <div  class="d-grid">
                            <button class="btn btn-primary btn-lg mt-3" type="submit">
                            <i class="bi bi-plus-circle me-2"></i>{{_('Request Sticker')}}
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const icon = document.getElementById('infoIcon');
        const box = document.getElementById('infoBox');
        const iconApproval = document.getElementById('infoIconApproval');
        const boxApproval = document.getElementById('infoBoxApproval');

        // 1. Toggle visibility when icon is clicked
        icon.addEventListener('click', function(e) {
            e.stopPropagation(); // Stop the click from bubbling to the document
            box.classList.toggle('d-none');
        });

        // 2. Hide when clicking ANYWHERE else on the screen
        document.addEventListener('click', function(e) {
            // If the click is NOT inside the box AND NOT on the icon
            if (!box.contains(e.target) && e.target !== icon) {
                box.classList.add('d-none');
            }
        });

        // 3. Prevent clicking inside the box from closing it
        box.addEventListener('click', function(e) {
            e.stopPropagation();
        });

        iconApproval.addEventListener('click', function(e) {
            e.stopPropagation(); // Stop the click from bubbling to the document
            boxApproval.classList.toggle('d-none');
        });

        // 2. Hide when clicking ANYWHERE else on the screen
        document.addEventListener('click', function(e) {
            // If the click is NOT inside the box AND NOT on the icon
            if (!boxApproval.contains(e.target) && e.target !== iconApproval) {
                boxApproval.classList.add('d-none');
            }
        });

        // 3. Prevent clicking inside the box from closing it
        boxApproval.addEventListener('click', function(e) {
            e.stopPropagation();
        });
    });
</script>
{% endblock %}